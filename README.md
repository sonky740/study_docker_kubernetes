# Docker와 가상머신과의 차이

Docker와 가상 머신(VM)은 모두 소프트웨어 애플리케이션을 배포하고 관리할 수 있는
기술이지만, 둘 사이에는 몇 가지 주요 차이점이 있다.

- VM은 하드웨어를 가상화하기 때문에 낭비가 큼.
- Docker는 내장 컨테이너를 사용하기 때문에 VM에 비해 훨씬 가볍고 빠름.

- 아키텍처: Docker 컨테이너와 VM은 서로 다른 아키텍처를 가지고 있는데, Docker 컨
  테이너는 공유 커널을 사용하여 단일 호스트 운영 체제 위에서 실행되는 반면, VM은
  전체 운영 체제 환경을 에뮬레이트하는 하이퍼바이저에서 실행됩니다.
- 리소스 활용: Docker 컨테이너는 일반적으로 VM보다 가볍고 더 적은 리소스를 사용,
  VM은 자체 운영 체제와 전용 시스템 리소스가 필요한 반면, 각 Docker 컨테이너는호
  스트 OS 커널을 공유하며 별도의 운영 체제 인스턴스가 필요하지 않음.
- 배포 속도: VM은 일반적으로 시작하는 데 시간이 오래 걸리는 반면, Docker 컨테이
  너는 단 몇 초 만에 빠르게 배포하고 시작 가능.
- 격리: 두 기술 모두 어느 정도 수준의 격리를 제공하지만, Docker 컨테이너는 프로
  세스 수준 격리를 제공하므로 각 컨테이너는 프로세스 수준에서 격리되고 호스트 OS
  커널을 공유한다. VM은 자체 운영 체제 인스턴스와 커널로 완벽한 격리를 제공.
- 이동성: Docker 컨테이너는 수정이 거의 또는 전혀 없이 호스트와 환경 간에 쉽게이
  동할 수 있기 때문에 일반적으로 VM보다 이식성이 뛰어나다. VM은 다른 호스트 간에
  이동할 때 추가 구성 및 설정이 필요할 수 있음.
- 관리: VM은 별도의 관리 도구와 인터페이스가 필요한 반면, Docker 컨테이너는 단일
  명령줄 인터페이스를 사용하여 관리 가능.

전반적으로 Docker와 VM은 서로 다른 사용 사례와 이점을 가지고 있으며, 둘 중 어떤
것을 선택할지는 사용 중인 애플리케이션이나 환경의 특정 요구사항에 따라 달라진다.
일반적으로 신속한 배포, 높은 리소스 활용도, 손쉬운 관리가 필요한 애플리케이션에
는 Docker가 더 적합한 반면, 완전한 격리 및 특정 운영 체제 환경과의 호환성이필요
한 애플리케이션에는 VM이 더 적합할 수 있음.

# Docker의 장점

- 이식성: 다양한 운영 체제 및 환경에 배포할 수 있으므로 개발, 테스트 및 프로덕션
  환경 간에 애플리케이션을 쉽게 이동 가능.
- 확장성: 추가 하드웨어나 구성을 변경할 필요 없이 애플리케이션을 쉽게 확장하거나
  축소 가능.
- 격리: 애플리케이션 간에 격리 기능을 제공하여 한 애플리케이션이 다른 애플리케이
  션의 성능이나 안정성에 영향을 미치지 않도록 보장.
- 실행환경 구성이 빠르고 간단.
- 리소스 효율성: 기존 가상 머신보다 리소스를 적게 사용함. 효율적.
- nodejs로 비교하자면(정확히는 서로 비교 대상이 아니지만) 특정 노드 버전을
  Docker 컨테이너에 고정할 수 있으므로 코드가 항상 정확한 버전으로 실행되도록 할
  수 있음.

# Docker의 단점

- 보안: 호스트 운영 체제로부터 완전히 격리되지 않으므로 제대로 구성하지 않으면보
  안 위험이 발생할 수 있음.
- 일부 운영 체제에 대한 지원이 제한적: 주로 Linux용으로 설계되었기 때문에 일부애
  플리케이션에 대한 유용성이 제한됨.
- 성능 오버헤드: 가상 머신보다 리소스 효율이 높지만 컨테이너화와 관련된 성능 오
  버헤드가 여전히 존재.

## Docker 명령어

- docker build . : 현재 디렉토리에 있는 Dockerfile을 사용하여 이미지를 빌드함.
- docker run -p 80:80 id : id에 해당하는 이미지를 실행함.
- docker ps : 실행 중인 컨테이너 목록을 보여줌.
- docker stop NAMES : 실행 중인 컨테이너를 중지함.

## Docker 공유

- docker push [image name] : 로컬에 있는 이미지를 Docker Hub에 공유함.
  - docker login 후 사용 가능.
  - docker tag [image name] [docker hub id]/[image name] : 이미지에 태그를 붙임.
    [docker hub id]/[image name]: `[image name]`이 됨.
  - docker pull [image name] : Docker Hub에 공유된 이미지를 로컬에 다운로드함.

## Docker key idea

image는 read-only  
container는 read-write 가능  
image와 container와 로컬 파일 시스템은 서로 연결되어 있지 않음.  
그러므로 container에서 파일을 생성하면 로컬 파일 시스템에는 영향을 미치지 않음
.  
container를 삭제한다면 container에 생성된 파일은 삭제됨.

## Volumes

Docker에서 볼륨은 컨테이너의 파일 시스템 외부에 데이터를 지속시키는 방법. 이를통
해 컨테이너 간은 물론 컨테이너와 호스트 머신 간에 데이터를 저장하고 공유 가능
.  
Docker 컨테이너를 생성하면 일반적으로 컨테이너가 중지되거나 삭제되면 파일 시스템
에 대한 모든 변경 사항이 손실. 볼륨을 사용하면 컨테이너의 파일 시스템에 있는 디
렉터리 또는 파일에 매핑될 호스트 머신의 디렉터리 또는 파일을 지정할 수 있는데,
이렇게 하면 컨테이너와 호스트 머신 간은 물론 다른 컨테이너 간에도 데이터를 공유
할 수 있다.

Docker에는 세 가지 유형의 볼륨이 있다.

- `익명 볼륨`: Docker에서 생성되며 호스트 머신의 디렉터리에 명시적으로 이름이 지
  정되거나 매핑되지 않은 볼륨. 익명 볼륨은 컨테이너가 존재하는 동안에만 존재하기
  때문에, 컨테이너가 삭제되면 마찬가지로 삭제됨.  
  ex) docker run -v /app/data ...
- `네임드 볼륨`: 이름이 지정되고 호스트 머신의디렉터리에 매핑되는 볼륨. 네임드볼
  륨은 컨테이너 간에 데이터를 공유하고 컨테이너가 삭제되거나 다시 생성될 때 데이
  터를 유지하는 데 사용할 수 있다.  
  ex) docker run -v data:/app/data ...

전반적으로 볼륨은 컨테이너와 호스트 머신 간에 데이터를 공유하고 유지할 수 있도록
해주는 Docker의 강력한 기능. 볼륨은 일반적으로 데이터베이스나 구성 파일과 같이컨
테이너가 다시 시작될 때 지속되어야 하는 데이터를 저장하는 데 사용된다.

## Bind Mounts

```sh
docker run -v /path/to/code:/app/code ...
```

이미지를 리빌드하지 않고도 수정된파일 반영을 바로 할 수 있음. 호스트 머신에서컨
테이너로 디렉터리 또는 파일을 마운트하는 방법. Docker에서 관리하고 Docker 내에서
만 액세스할 수 있는 볼륨과 달리, 바인드 마운트는 호스트 머신과 Docker 컨테이너간
에 데이터를 공유할 수 있는 방법을제공.  
바인드 마운트를 생성할 때 호스트 머신의 디렉터리 또는 파일과 호스트 디렉터리 또
는 파일의 콘텐츠가 마운트될 컨테이너의 디렉터리를 지정하면 컨테이너가 마치 파일
시스템의 일부인 것처럼 호스트 머신의 디렉터리 또는 파일 콘텐츠에 액세스하고 수정
할 수 있다.  
바인드 마운트는 볼륨에 비해 몇 가지 차이가 있다.

- 호스트 머신과 컨테이너 간에 공유할 파일과 디렉터리를 보다 세밀하게 제어할 수있
  으며,
- 서로 다른 호스트에서 실행 중인 컨테이너 간에 데이터를 공유하는 데 사용할 수 있
  다.
- 그러나 호스트 머신의 디렉토리 구조와 파일 권한에 따라 달라지기 때문에 볼륨보다
  이식성이 떨어질 수 있다.
